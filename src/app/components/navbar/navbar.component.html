<nav>
  <div id="nav-container">
    <!-- brand -->
    <div id="nav-brand">
      <button>
        <a (click)="navigateTo('/')">
          <span>3DVerse</span>
        </a>
      </button>
    </div>

    <!-- menu -->
    <div id="nav-menu" [class.active]="isMenuOpen">
      <ul>
        <li *ngFor="let item of navItems">
          <a (click)="navigateTo(item.path, item.fragment)" [class.active]="activeSection === item.fragment">
            {{item.label}}
          </a>
        </li>
        
        <!-- Opciones de autenticación -->
        <!-- <li *ngIf="!isAuthenticated">
          <a (click)="navigateTo('/login')">Iniciar Sesión</a>
        </li>
        <li *ngIf="!isAuthenticated">
          <a (click)="navigateTo('/register')">Registrarse</a>
        </li> -->
        <!-- <li *ngIf="isAuthenticated" class="user-menu">
          <a>Bienvenido, {{userName}}</a>
          <ul class="dropdown">
            <li><a (click)="navigateTo('/profile')">Perfil</a></li>
            <li><a (click)="logout()">Cerrar Sesión</a></li>
          </ul>
        </li> -->
      </ul>
    </div>

    <!-- icons -->
    <div class="nav-icons">
      <!-- user -->
      <button class="user-icon-button" (click)="toggleUserMenu()" aria-label="Usuario">
        <svg class="user-icon" viewBox="0 0 24 24">
          <path fill="currentColor" d="M12,4A4,4 0 0,1 16,8A4,4 0 0,1 12,12A4,4 0 0,1 8,8A4,4 0 0,1 12,4M12,14C16.42,14 20,15.79 20,18V20H4V18C4,15.79 7.58,14 12,14Z" />
        </svg>
      </button>
      
      <!-- cart -->
      <button class="cart-icon-button" 
        (click)="navigateTo('/cart', 'cart-container')" 
        aria-label="Carrito de compras"
        [class.pulse]="isCartPulsing">
        <svg class="cart-icon" viewBox="0 0 24 24">
          <path fill="currentColor" d="M17,18A2,2 0 0,1 19,20A2,2 0 0,1 17,22C15.89,22 15,21.1 15,20C15,18.89 15.89,18 17,18M1,2H4.27L5.21,4H20A1,1 0 0,1 21,5C21,5.17 20.95,5.34 20.88,5.5L17.3,11.97C16.96,12.58 16.3,13 15.55,13H8.1L7.2,14.63L7.17,14.75A0.25,0.25 0 0,0 7.42,15H19V17H7A2,2 0 0,1 5,15C5,14.65 5.09,14.32 5.24,14.04L6.6,11.59L3,4H1V2M7,18A2,2 0 0,1 9,20A2,2 0 0,1 7,22C5.89,22 5,21.1 5,20C5,18.89 5.89,18 7,18M16,11L18.78,6H6.14L8.5,11H16Z"/>
        </svg>
        <span class="cart-count" *ngIf="cartItemsCount > 0">{{cartItemsCount}}</span>
      </button>

      <!-- hamburger -->
      <button id="nav-toggle" class="hamburger" (click)="toggleMenu()">
        <span class="material-icons">menu</span>
      </button>
    </div>
  </div>


    <!-- User dropdown menu -->
    <div class="user-dropdown" [class.active]="isUserMenuOpen">
      <div *ngIf="!isAuthenticated">
        <button (click)="navigateTo('/login'); toggleUserMenu();">Iniciar sesión</button>
        <button (click)="navigateTo('/register'); toggleUserMenu();">Registrarse</button>
      </div>
      <div *ngIf="isAuthenticated">
        <span>{{userName}}</span>
        <button (click)="navigateTo('/profile'); toggleUserMenu();">Mi perfil</button>
        <!-- <button *ngIf="isAdmin" (click)="navigateTo('/admin')">Panel de admin</button> -->
        <button (click)="logout()">Cerrar sesión</button>
      </div>
    </div>
</nav>